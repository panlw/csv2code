-- M_DISCOUNT
CREATE INDEX M_DISCOUNT_I1 ON M_DISCOUNT (CUST_AN8,MCU_CODE,PG_ID,SINCE_JD,UNTIL_JD);
CREATE INDEX M_DISCOUNT_I2 ON M_DISCOUNT (CUST_AN8,MCU_CODE,ITEM_NO,SINCE_JD,UNTIL_JD);
CREATE INDEX M_DISCOUNT_I3 ON M_DISCOUNT (MCU_CODE,PG_ID,SINCE_JD,UNTIL_JD);
CREATE INDEX M_DISCOUNT_I4 ON M_DISCOUNT (MCU_CODE,ITEM_NO,SINCE_JD,UNTIL_JD);

-- M_BP_MCU_ITEM (rows=37809)
INSERT INTO M_BP_MCU_ITEM SELECT * FROM S_M_BP_MCU_ITEM
where MCU_CODE='      180269'/*宁波分公司仓库*/ or MCU_CODE='      180309'/*上海分公司仓库*/;

-- S_M_DISCOUNT (rows=10816)
INSERT INTO M_DISCOUNT SELECT * FROM S_M_DISCOUNT
where MCU_CODE='      180269'/*宁波分公司仓库*/ or MCU_CODE='      180309'/*上海分公司仓库*/;

-- JULIAN DATE
select 100000+TO_CHAR(SYSDATE,'YYDDD') J from dual;

-- F41021 -- ROWS of 100 DAYS = 120151
select count(1) N
from PRODDTA.F41021
where LIUPMJ between 117128 and 117228
and LIGLPT='IN01' and LILOCN=' ' and LIMCU like '      18%';

-- F4106 -- ROWS of 100 DAYS = 14313
select count(1) N
from PRODDTA.F4106
where BPUPMJ between 117128 and 117228
and BPMCU like '      18%';
